<p-confirmdialog />

<p *ngIf="loading">Carregando...</p>
<p *ngIf="error" class="error">{{ error }}</p>
<p-card class="card">
  <p-table
    #dt
    *ngIf="!loading"
    [value]="employees"
    dataKey="id"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[5, 10, 20]"
    size="small"
    stripedRows
    [globalFilterFields]="['name', 'email', 'role', 'active']"
  >
    <!-- CAPTION: só busca global à direita -->
    <ng-template #caption>
      <div class="table-caption">
        <p-iconfield iconPosition="left">
          <p-inputicon>
            <i class="pi pi-search"></i>
          </p-inputicon>
          <input
            pInputText
            type="text"
            [(ngModel)]="searchField"
            placeholder="Buscar funcionário"
            (input)="dt.filterGlobal($event.target.value, 'contains')"
          />
          <p-button label="Clear" [outlined]="true" icon="pi pi-filter-slash" (click)="clear(dt)" />
        </p-iconfield>
      </div>
    </ng-template>

    <!-- HEADER -->
    <ng-template #header>
      <!-- títulos -->
      <tr>
        <th pSortableColumn="name" style="width: 25%">
          Nome
          <p-sortIcon field="name" />
        </th>

        <th pSortableColumn="email" style="width: 25%">
          Email
          <p-sortIcon field="email" />
        </th>

        <th pSortableColumn="role" style="width: 20%">
          Função
          <p-sortIcon field="role" />
        </th>

        <th pSortableColumn="active" style="width: 15%">
          Ativo
          <p-sortIcon field="active" />
        </th>

        <th style="width: 15%">Ações</th>
      </tr>
    </ng-template>

    <!-- BODY -->
    <ng-template #body let-e>
      <tr>
        <td>{{ e.name }}</td>
        <td>{{ e.email }}</td>
        <td>{{ e.role }}</td>
        <td>
          <span class="status" [class.active]="e.active" [class.inactive]="!e.active">
            {{ e.active ? 'Sim' : 'Não' }}
          </span>
        </td>
        <td>
          <p-button icon="pi pi-pencil" severity="warn" text (click)="onEdit(e)" />
          <p-button icon="pi pi-trash" severity="danger" text (click)="confirm($event, e)" />
        </td>
      </tr>
    </ng-template>

    <!-- EMPTY -->
    <ng-template #emptymessage>
      <tr>
        <td colspan="5">Nenhum funcionário encontrado.</td>
      </tr>
    </ng-template>
  </p-table>
</p-card>
